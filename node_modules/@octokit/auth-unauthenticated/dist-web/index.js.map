{"version":3,"file":"index.js","sources":["../dist-src/auth.js","../dist-src/is-rate-limit-error.js","../dist-src/is-abuse-limit-error.js","../dist-src/hook.js","../dist-src/index.js"],"sourcesContent":["export async function auth(reason) {\n    return {\n        type: \"unauthenticated\",\n        reason,\n    };\n}\n","export function isRateLimitError(error) {\n    if (error.status !== 403) {\n        return false;\n    }\n    /* istanbul ignore if */\n    if (!error.headers) {\n        return false;\n    }\n    return error.headers[\"x-ratelimit-remaining\"] === \"0\";\n}\n","const REGEX_ABUSE_LIMIT_MESSAGE = /\\babuse\\b/i;\nexport function isAbuseLimitError(error) {\n    if (error.status !== 403) {\n        return false;\n    }\n    return REGEX_ABUSE_LIMIT_MESSAGE.test(error.message);\n}\n","import { RequestError } from \"@octokit/request-error\";\nimport { isRateLimitError } from \"./is-rate-limit-error\";\nimport { isAbuseLimitError } from \"./is-abuse-limit-error\";\nconst MUTATING_METHODS = [\"DELETE\", \"PATCH\", \"POST\", \"PUT\"];\nexport async function hook(reason, request, route, parameters) {\n    const endpoint = request.endpoint.merge(route, parameters);\n    if (MUTATING_METHODS.includes(endpoint.method)) {\n        throw new RequestError(`\"${endpoint.method} ${endpoint.url}\" is not permitted due to lack authentication. Reason: ${reason}`, 403, {\n            request: request.endpoint.parse(endpoint),\n        });\n    }\n    return request(endpoint).catch((error) => {\n        if (error.status === 404) {\n            error.message = `Not found. May be due to lack of authentication. Reason: ${reason}`;\n        }\n        if (isRateLimitError(error)) {\n            error.message = `API rate limit exceeded. This maybe caused by the lack of authentication. Reason: ${reason}`;\n        }\n        if (isAbuseLimitError(error)) {\n            error.message = `You have triggered an abuse detection mechanism. This maybe caused by the lack of authentication. Reason: ${reason}`;\n        }\n        throw error;\n    });\n}\n","import { auth } from \"./auth\";\nimport { hook } from \"./hook\";\nexport const createUnauthenticatedAuth = function createUnauthenticatedAuth(options) {\n    if (!options || !options.reason) {\n        throw new Error(\"[@octokit/auth-unauthenticated] No reason passed to createUnauthenticatedAuth\");\n    }\n    return Object.assign(auth.bind(null, options.reason), {\n        hook: hook.bind(null, options.reason),\n    });\n};\n"],"names":[],"mappings":";;AAAO,eAAe,IAAI,CAAC,MAAM,EAAE;AACnC,IAAI,OAAO;AACX,QAAQ,IAAI,EAAE,iBAAiB;AAC/B,QAAQ,MAAM;AACd,KAAK,CAAC;AACN;;ACLO,SAAS,gBAAgB,CAAC,KAAK,EAAE;AACxC,IAAI,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,EAAE;AAC9B,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK;AACL;AACA,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE;AACxB,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK;AACL,IAAI,OAAO,KAAK,CAAC,OAAO,CAAC,uBAAuB,CAAC,KAAK,GAAG,CAAC;AAC1D,CAAC;;ACTD,MAAM,yBAAyB,GAAG,YAAY,CAAC;AAC/C,AAAO,SAAS,iBAAiB,CAAC,KAAK,EAAE;AACzC,IAAI,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,EAAE;AAC9B,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK;AACL,IAAI,OAAO,yBAAyB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AACzD,CAAC;;ACHD,MAAM,gBAAgB,GAAG,CAAC,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;AAC5D,AAAO,eAAe,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE;AAC/D,IAAI,MAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;AAC/D,IAAI,IAAI,gBAAgB,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;AACpD,QAAQ,MAAM,IAAI,YAAY,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,QAAQ,CAAC,GAAG,CAAC,uDAAuD,EAAE,MAAM,CAAC,CAAC,EAAE,GAAG,EAAE;AAC3I,YAAY,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC;AACrD,SAAS,CAAC,CAAC;AACX,KAAK;AACL,IAAI,OAAO,OAAO,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,KAAK;AAC9C,QAAQ,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,EAAE;AAClC,YAAY,KAAK,CAAC,OAAO,GAAG,CAAC,yDAAyD,EAAE,MAAM,CAAC,CAAC,CAAC;AACjG,SAAS;AACT,QAAQ,IAAI,gBAAgB,CAAC,KAAK,CAAC,EAAE;AACrC,YAAY,KAAK,CAAC,OAAO,GAAG,CAAC,kFAAkF,EAAE,MAAM,CAAC,CAAC,CAAC;AAC1H,SAAS;AACT,QAAQ,IAAI,iBAAiB,CAAC,KAAK,CAAC,EAAE;AACtC,YAAY,KAAK,CAAC,OAAO,GAAG,CAAC,0GAA0G,EAAE,MAAM,CAAC,CAAC,CAAC;AAClJ,SAAS;AACT,QAAQ,MAAM,KAAK,CAAC;AACpB,KAAK,CAAC,CAAC;AACP,CAAC;;ACrBW,MAAC,yBAAyB,GAAG,SAAS,yBAAyB,CAAC,OAAO,EAAE;AACrF,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;AACrC,QAAQ,MAAM,IAAI,KAAK,CAAC,+EAA+E,CAAC,CAAC;AACzG,KAAK;AACL,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC,EAAE;AAC1D,QAAQ,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC;AAC7C,KAAK,CAAC,CAAC;AACP,CAAC;;;;"}